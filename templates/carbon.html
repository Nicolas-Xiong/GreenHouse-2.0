{% extends 'navigation_2.html' %}

{% block a %} 
<div class="side-nav expand-lg">
			<div class="side-nav-inner">
				<ul class="side-nav-menu">
					<li class="side-nav-header">
						<h2 style="color:#c5c5c5">导航栏</h2>
					</li>
					<li class="nav-item dropdown">
						<a href="#" class="dropdown-toggle">
							<span class="icon-holder">
								<i class="lni-dashboard"></i>
							</span>
							<span class="title">近期数据</span>
							<span class="arrow">
							<i class="lni-chevron-right"></i>
							</span>
						</a>
						<ul class="dropdown-menu sub-down">
							<li>
								<a href="navigation_2">一小时内</a>
							</li>
							<li>
								<a href="navigation_2_2">一天内</a>
							</li>
						</ul>
					</li>
					<li class="nav-item dropdown">
						<a class="dropdown-toggle" href="#">
							<span class="icon-holder">
								<i class="lni-camera"></i>
							</span>
							<span class="title">视频监控</span>
							<span class="arrow">
							<i class="lni-chevron-right"></i>
							</span>
						</a>
						<ul class="dropdown-menu sub-down">
							<li>
								<a href="video">窗口一</a>
							</li>
							<li>
								<a href="video_2">窗口二</a>
							</li>
							<li>
								<a href="video_3">窗口三</a>
							</li>
							<li>
								<a href="video_4">窗口四</a>
							</li>
						</ul>
					</li>
					<li class="nav-item dropdown">
						<a class="dropdown-toggle" href="#">
							<span class="icon-holder">
								<i class="lni-cloud"></i>
							</span>
							<span class="title">天气预报</span>
							<span class="arrow">
							<i class="lni-chevron-right"></i>
							</span>
						</a>
						<ul class="dropdown-menu sub-down">
						<li>
							<a href="weather_true">天气</a>
						</li>
						</ul>
					</li>
					<li class="nav-item dropdown  open">
						<a class="dropdown-toggle" href="#">
						<span class="icon-holder">
							<i class="lni-timer"></i>
						</span>
						<span class="title">历史数据</span>
						<span class="arrow">
						<i class="lni-chevron-right"></i>
						</span>
						</a>
						<ul class="dropdown-menu sub-down">
							<li>
								<a href="temperature">历史温度</a>
							</li>
							<li >
								<a href="humidity">历史湿度</a>
							</li>
							<li >
								<a href="lux">历史光照度</a>
							</li>
							<li class="active">
								<a href="carbon">历史CO2含量</a>
							</li>
						</ul>
					</li>
					<li class="nav-item dropdown">
						<a class="dropdown-toggle" href="#">
							<span class="icon-holder">
								<i class="lni-files"></i>
							</span>
							<span class="title">特殊页面</span>
							<span class="arrow">
							<i class="lni-chevron-right"></i>
							</span>
						</a>
					<ul class="dropdown-menu sub-down">
						<li>
							<a href="profile">简介</a>
						</li>
						<li>
							<a href="settings">设置</a>
						</li>
						<li>
							<a href="{{ url_for('login') }}">登录</a>
						</li>
						<li>
							<a href="sign_up">注册</a>
						</li>
						<li>
							<a href="forgot_password">忘记密码</a>
						</li>
						<li>
							<a href="_404">404错误</a>
						</li>
					</ul>
					</li>
					</ul>
			</div>
		</div>
{% endblock %}

{% block b %} 
				<div class="breadcrumb-wrapper row">
					<div class="col-12 col-lg-3 col-md-6">
						<h4 class="page-title">历史CO2含量</h4>
					</div>
					<div class="col-12 col-lg-9 col-md-6">
						<ol class="breadcrumb float-right">
							<li><a href="temperature">历史数据</a></li>
							<li class="active">/ 历史CO2含量</li>
						</ol>
					</div>
				</div>
{% endblock %}

{% block c %} 
<div class="row">
	<div class="col-md-6">
		<div class="card">
			<div class="row m-t-20 m-b-20">
				<div class='col-md-12'>
					<form method="POST">
						<div class='input-group date custom-control custom-control-inline' >
							<input type='text' class="form-control" name="date" placeholder="2020/1/1到昨天的数据" id='datetimepicker3'/>
							<button type="submit" class="btn btn-outline-success" style="margin-left: 20px;margin-right: 20px;">确定</button>
						</div>
					</form>
				</div>
				<div class="col-md-12">
					{% if status==1 %} 
					<div class="alert  alert-dismissible m-t-10">
						<font color="#00aa00"><b>只有2020/1/1至昨天的数据哟</b></font>
					</div>
					{% elif status==2 %}
					<div class="alert  alert-dismissible m-t-10">
						<font color="#00aa00"><b>什么也没有输入</b></font>
					</div>
					{% endif %}
				</div>
			</div>
			<div>
				<h2 class="text-muted" style="text-align:center;margin-top: 15px;">日期{{data.date}}</h2>
			</div>
			<div class='col-md-12'>
				<div id="main_carbon" style="height: 300px"></div>
			</div>
		</div>
		<div class="card">
			<a class="d-flex justify-content-center" href="{{ url_for('carbon_download') }}" download="carbon.xlsx">  <!-- url_for获取函数所对应url -->
				<div type="submit" class="btn btn-outline-success" style="margin: 20px;">以excel格式下载全部CO2含量数据</div>
			</a>
		</div>
	</div>
	<div class="col-md-6">
		<div class="card">
			<div class="row m-b-20">
				<div class='col-md-12'>
					<div>
						<h2 class="text-muted" style="text-align:center;margin-top: 15px;">日期{{data.date}}</h2>
					</div>
					<table id="tb" class="table table-hover table-light table-sm">
					</table>
				</div>
			</div>
		</div>
	</div>
</div>
{% endblock %}

{% block d %} 
		<script src="../static/js/moment-with-locales.js"></script>
		<script src="../static/js/bootstrap-datetimepicker.js"></script>
		
        <script type="text/javascript">
			var myChart_carbon = echarts.init(document.getElementById('main_carbon'));
			var data={{data|tojson}}
			var s = '<thead class="thead-dark"> <tr><th style="color: #ffffff;">时间</th><th style="color: #ffffff;">CO2含量</th></tr></thead>';
			for (var i = 0; i<24 ; i++) {
				s += '<tr><td>' + data.time[i] + '</td><td style="color: #ff00ff;">' + data.co2[i] + 'ppm</td></tr>';
			};
			document.getElementById("tb").innerHTML = s;
			myChart_carbon.showLoading({color: '#00aa00'});
            $(function () {
                $('#datetimepicker3').datetimepicker({
                    locale: 'zh-cn',viewMode: 'days',format: 'YYYY/MM/DD'
                });
				myChart_carbon.hideLoading({color: '#00aa00'});
				myChart_carbon.setOption({
					legend: {
					    data: ['CO2含量(ppm)'],
						textStyle: {
						  color: "#000000"
						},
					},
					tooltip: [{
						trigger: 'axis', 						
						axisPointer: {  //坐标轴指示器，坐标轴触发有效，
						    type: 'cross', //默认为line，line直线，cross十字准星，shadow阴影
							crossStyle: {
						        color: '#000000'//白色
							}
						},
					}],
				    xAxis: [
						{
							type:'category',
							data:data.time,
							axisLabel: {
							  textStyle: {
							    color: "#000000"
							  },
							},
						}
					],
					yAxis: [
						{
							type:'value',
							name: 'CO2含量',
							min: 0,
							max: 800,
							splitLine:{
							　　　　show:false
							　　},
							axisLabel: {
							    textStyle: {
								    color: "#000000"
								              },
							    formatter: '{value}'
						}
						}],
					series: [{//默认第一个图第一个轴
					    name: 'CO2含量(ppm)',
					    type: 'bar',
						itemStyle: {
						//通常情况下：
						normal: {
						    //每个柱子的颜色即为colorList数组里的每一项，如果柱子数目多于colorList的长度，则柱子颜色循环使用该数组
						    color: '#00aa00'
							}
							},
						data:data.co2,
					}],
				});
            });
        </script>
		<script src="../static/js/base.js"></script>
{% endblock %}


